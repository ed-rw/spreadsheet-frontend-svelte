import{S as e,i as t,s,k as r,f as l,C as n,x as a,D as o,w as c,d,G as i,m as h,H as f,E as p,e as u,c as $,a as g,J as m,F as v,u as b,o as E,g as w,j as x,p as C,T as S,l as T,q as k,r as y,y as D,t as j,b as z,h as H,n as R,X as q}from"../../chunks/preload-helper-35d26f2d.js";import{c as A,b as I,d as B,R as L,C as M}from"../../chunks/Row-42c45be0.js";function N(e){let t,s;const r=e[12].default,n=p(r,e,e[11],null);let o=[e[3],{class:e[1]}],i={};for(let l=0;l<o.length;l+=1)i=h(i,o[l]);return{c(){t=u("table"),n&&n.c(),this.h()},l(e){t=$(e,"TABLE",{class:!0});var s=g(t);n&&n.l(s),s.forEach(d),this.h()},h(){m(t,i)},m(e,r){l(e,t,r),n&&n.m(t,null),s=!0},p(e,l){n&&n.p&&2048&l&&v(n,r,e,e[11],l,null,null),m(t,i=b(o,[8&l&&e[3],(!s||2&l)&&{class:e[1]}]))},i(e){s||(c(n,e),s=!0)},o(e){a(n,e),s=!1},d(e){e&&d(t),n&&n.d(e)}}}function F(e){let t,s,r;const n=e[12].default,o=p(n,e,e[11],null);let i=[e[3],{class:e[1]}],f={};for(let l=0;l<i.length;l+=1)f=h(f,i[l]);return{c(){t=u("div"),s=u("table"),o&&o.c(),this.h()},l(e){t=$(e,"DIV",{class:!0});var r=g(t);s=$(r,"TABLE",{class:!0});var l=g(s);o&&o.l(l),l.forEach(d),r.forEach(d),this.h()},h(){m(s,f),E(t,"class",e[2])},m(e,n){l(e,t,n),w(t,s),o&&o.m(s,null),r=!0},p(e,l){o&&o.p&&2048&l&&v(o,n,e,e[11],l,null,null),m(s,f=b(i,[8&l&&e[3],(!r||2&l)&&{class:e[1]}])),(!r||4&l)&&E(t,"class",e[2])},i(e){r||(c(o,e),r=!0)},o(e){a(o,e),r=!1},d(e){e&&d(t),o&&o.d(e)}}}function G(e){let t,s,i,h;const f=[F,N],p=[];function u(e,t){return e[0]?0:1}return t=u(e),s=p[t]=f[t](e),{c(){s.c(),i=r()},l(e){s.l(e),i=r()},m(e,s){p[t].m(e,s),l(e,i,s),h=!0},p(e,[r]){let l=t;t=u(e),t===l?p[t].p(e,r):(n(),a(p[l],1,1,(()=>{p[l]=null})),o(),s=p[t],s?s.p(e,r):(s=p[t]=f[t](e),s.c()),c(s,1),s.m(i.parentNode,i))},i(e){h||(c(s),h=!0)},o(e){a(s),h=!1},d(e){p[t].d(e),e&&d(i)}}}function J(e,t,s){let r,l;const n=["class","size","bordered","borderless","striped","dark","hover","responsive"];let a=i(t,n),{$$slots:o={},$$scope:c}=t,{class:d=""}=t,{size:p=""}=t,{bordered:u=!1}=t,{borderless:$=!1}=t,{striped:g=!1}=t,{dark:m=!1}=t,{hover:v=!1}=t,{responsive:b=!1}=t;return e.$$set=e=>{t=h(h({},t),f(e)),s(3,a=i(t,n)),"class"in e&&s(4,d=e.class),"size"in e&&s(5,p=e.size),"bordered"in e&&s(6,u=e.bordered),"borderless"in e&&s(7,$=e.borderless),"striped"in e&&s(8,g=e.striped),"dark"in e&&s(9,m=e.dark),"hover"in e&&s(10,v=e.hover),"responsive"in e&&s(0,b=e.responsive),"$$scope"in e&&s(11,c=e.$$scope)},e.$$.update=()=>{2032&e.$$.dirty&&s(1,r=A(d,"table",!!p&&"table-"+p,!!u&&"table-bordered",!!$&&"table-borderless",!!g&&"table-striped",!!m&&"table-dark",!!v&&"table-hover")),1&e.$$.dirty&&s(2,l=!0===b?"table-responsive":`table-responsive-${b}`)},[b,r,l,a,d,p,u,$,g,m,v,c,o]}class P extends e{constructor(e){super(),t(this,e,J,G,s,{class:4,size:5,bordered:6,borderless:7,striped:8,dark:9,hover:10,responsive:0})}}function V(e){if(0==e)return null;let t=[];for(;e>0;){let s=e%26;e=Math.floor(e/26),0==s&&(e-=1,s+=26);const r=s+64;t.push(String.fromCharCode(r))}return t.reverse().join("")}function X(e,t,s){const r=e.slice();return r[8]=t[s],r[10]=s,r}function K(e,t,s){const r=e.slice();return r[8]=t[s],r[12]=s,r}function O(e,t,s){const r=e.slice();return r[8]=t[s],r[12]=s,r}function Q(e){let t,s,r=V(e[1]+e[12])+"";return{c(){t=u("th"),s=j(r)},l(e){t=$(e,"TH",{});var l=g(t);s=z(l,r),l.forEach(d)},m(e,r){l(e,t,r),w(t,s)},p(e,t){2&t&&r!==(r=V(e[1]+e[12])+"")&&H(s,r)},d(e){e&&d(t)}}}function U(e){let t,s,r=e[5](e[12],e[10]).value+"";return{c(){t=u("td"),s=j(r)},l(e){t=$(e,"TD",{});var l=g(t);s=z(l,r),l.forEach(d)},m(e,r){l(e,t,r),w(t,s)},p:R,d(e){e&&d(t)}}}function W(e){let t,s,r,n,a,o=e[3]+e[10]+"",c={length:e[2]-e[1]},i=[];for(let l=0;l<c.length;l+=1)i[l]=U(K(e,c,l));return{c(){t=u("tr"),s=u("td"),r=j(o),n=x();for(let e=0;e<i.length;e+=1)i[e].c();a=x()},l(e){t=$(e,"TR",{});var l=g(t);s=$(l,"TD",{});var c=g(s);r=z(c,o),c.forEach(d),n=T(l);for(let t=0;t<i.length;t+=1)i[t].l(l);a=T(l),l.forEach(d)},m(e,o){l(e,t,o),w(t,s),w(s,r),w(t,n);for(let s=0;s<i.length;s+=1)i[s].m(t,null);w(t,a)},p(e,s){if(8&s&&o!==(o=e[3]+e[10]+"")&&H(r,o),38&s){let r;for(c={length:e[2]-e[1]},r=0;r<c.length;r+=1){const l=K(e,c,r);i[r]?i[r].p(l,s):(i[r]=U(l),i[r].c(),i[r].m(t,a))}for(;r<i.length;r+=1)i[r].d(1);i.length=c.length}},d(e){e&&d(t),q(i,e)}}}function Y(e){let t,s,n,a,o,c,i={length:e[2]-e[1]},h=[];for(let r=0;r<i.length;r+=1)h[r]=Q(O(e,i,r));let f={length:e[4]-e[3]},p=[];for(let r=0;r<f.length;r+=1)p[r]=W(X(e,f,r));return{c(){t=u("thead"),s=u("tr"),n=u("th"),a=x();for(let e=0;e<h.length;e+=1)h[e].c();o=x();for(let e=0;e<p.length;e+=1)p[e].c();c=r()},l(e){t=$(e,"THEAD",{});var l=g(t);s=$(l,"TR",{});var i=g(s);n=$(i,"TH",{}),g(n).forEach(d),a=T(i);for(let t=0;t<h.length;t+=1)h[t].l(i);i.forEach(d),l.forEach(d),o=T(e);for(let t=0;t<p.length;t+=1)p[t].l(e);c=r()},m(e,r){l(e,t,r),w(t,s),w(s,n),w(s,a);for(let t=0;t<h.length;t+=1)h[t].m(s,null);l(e,o,r);for(let t=0;t<p.length;t+=1)p[t].m(e,r);l(e,c,r)},p(e,t){if(6&t){let r;for(i={length:e[2]-e[1]},r=0;r<i.length;r+=1){const l=O(e,i,r);h[r]?h[r].p(l,t):(h[r]=Q(l),h[r].c(),h[r].m(s,null))}for(;r<h.length;r+=1)h[r].d(1);h.length=i.length}if(62&t){let s;for(f={length:e[4]-e[3]},s=0;s<f.length;s+=1){const r=X(e,f,s);p[s]?p[s].p(r,t):(p[s]=W(r),p[s].c(),p[s].m(c.parentNode,c))}for(;s<p.length;s+=1)p[s].d(1);p.length=f.length}},d(e){e&&d(t),q(h,e),e&&d(o),q(p,e),e&&d(c)}}}function Z(e){let t,s,r,n,o,i=e[0].name+"";return n=new P({props:{$$slots:{default:[Y]},$$scope:{ctx:e}}}),{c(){t=u("h1"),s=j(i),r=x(),C(n.$$.fragment)},l(e){t=$(e,"H1",{});var l=g(t);s=z(l,i),l.forEach(d),r=T(e),k(n.$$.fragment,e)},m(e,a){l(e,t,a),w(t,s),l(e,r,a),y(n,e,a),o=!0},p(e,t){(!o||1&t)&&i!==(i=e[0].name+"")&&H(s,i);const r={};16414&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){o||(c(n.$$.fragment,e),o=!0)},o(e){a(n.$$.fragment,e),o=!1},d(e){e&&d(t),e&&d(r),D(n,e)}}}function _(e){let t,s;return t=new M({props:{$$slots:{default:[Z]},$$scope:{ctx:e}}}),{c(){C(t.$$.fragment)},l(e){k(t.$$.fragment,e)},m(e,r){y(t,e,r),s=!0},p(e,s){const r={};16415&s&&(r.$$scope={dirty:s,ctx:e}),t.$set(r)},i(e){s||(c(t.$$.fragment,e),s=!0)},o(e){a(t.$$.fragment,e),s=!1},d(e){D(t,e)}}}function ee(e){let t,s,r,n;return document.title=t=e[0].name,r=new L({props:{$$slots:{default:[_]},$$scope:{ctx:e}}}),{c(){s=x(),C(r.$$.fragment)},l(e){S('[data-svelte="svelte-1vbcqq"]',document.head).forEach(d),s=T(e),k(r.$$.fragment,e)},m(e,t){l(e,s,t),y(r,e,t),n=!0},p(e,[s]){(!n||1&s)&&t!==(t=e[0].name)&&(document.title=t);const l={};16415&s&&(l.$$scope={dirty:s,ctx:e}),r.$set(l)},i(e){n||(c(r.$$.fragment,e),n=!0)},o(e){a(r.$$.fragment,e),n=!1},d(e){e&&d(s),D(r,e)}}}async function te({page:e,fetch:t,session:s,context:r}){const[l,n]=await Promise.all([I(e.params.spreadsheetId),B(e.params.spreadsheetId)]);return{props:{spreadsheet:await l.json(),spreadsheetCells:(await n.json()).reduce(((e,t)=>e.set(t.name,t.data)),new Map)}}}function se(e,t,s){let{spreadsheet:r}=t,{spreadsheetCells:l}=t,{colStart:n=1}=t,{colEnd:a=10}=t,{rowStart:o=1}=t,{rowEnd:c=10}=t,d={value:"",type:"empty"};return e.$$set=e=>{"spreadsheet"in e&&s(0,r=e.spreadsheet),"spreadsheetCells"in e&&s(6,l=e.spreadsheetCells),"colStart"in e&&s(1,n=e.colStart),"colEnd"in e&&s(2,a=e.colEnd),"rowStart"in e&&s(3,o=e.rowStart),"rowEnd"in e&&s(4,c=e.rowEnd)},[r,n,a,o,c,function(e,t){let s=V(n+e),r=o+t;return l.get(s+r)||d},l]}export default class extends e{constructor(e){super(),t(this,e,se,ee,s,{spreadsheet:0,spreadsheetCells:6,colStart:1,colEnd:2,rowStart:3,rowEnd:4,getCellData:5})}get getCellData(){return this.$$.ctx[5]}}export{te as load};
